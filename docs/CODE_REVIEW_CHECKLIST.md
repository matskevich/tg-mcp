# üîç Code Review Checklist –¥–ª—è S16-leads

## üõ°Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô: –ê–Ω—Ç–∏-—Å–ø–∞–º –ø—Ä–æ–≤–µ—Ä–∫–∏**

### ‚ùó **–ë–õ–û–ö–ò–†–£–Æ–©–ò–ï –ø—Ä–æ–≤–µ—Ä–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)**

- [ ] **üö® Telegram API –≤—ã–∑–æ–≤—ã**
  - [ ] –í—Å–µ `client.*` –≤—ã–∑–æ–≤—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `_safe_api_call()` –∏–ª–∏ `safe_call()`
  - [ ] –ù–ï–¢ –ø—Ä—è–º—ã—Ö `await client.get_entity()`, `client.iter_participants()`, etc.
  - [ ] –ù–ï–¢ –ø—Ä—è–º—ã—Ö `async for user in client.iter_*()` –±–µ–∑ –æ–±–µ—Ä—Ç–∫–∏
  
- [ ] **üì• –ò–º–ø–æ—Ä—Ç—ã**
  - [ ] –§–∞–π–ª—ã —Å Telegram API –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç `safe_call` –∏–ª–∏ `_safe_api_call`
  - [ ] `from tganalytics.infra.limiter import safe_call` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
  
- [ ] **üß™ –¢–µ—Å—Ç—ã**
  - [ ] –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–µ—é—Ç —Ç–µ—Å—Ç—ã
  - [ ] –¢–µ—Å—Ç—ã –ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä—è–º—ã–µ API –≤—ã–∑–æ–≤—ã (—Ç–æ–ª—å–∫–æ –º–æ–∫–∏)
  - [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: `make test`

### ‚ö° **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏**

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–µ—Ä–µ–¥ —Ä–µ–≤—å—é:
```bash
# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
make dev-check

# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞  
make check-all

# –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∞—É–¥–∏—Ç Telegram API
make telegram-api-audit
```

---

## üìã **GENERAL CODE REVIEW**

### **üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

- [ ] **–°–ª–æ–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã**
  - [ ] `src/core/` - –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞
  - [ ] `src/infra/` - –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Telegram, –ª–∏–º–∏—Ç–µ—Ä—ã)
  - [ ] `examples/` - –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  
- [ ] **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã**
  - [ ] –ù–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
  - [ ] Core –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç infra –Ω–∞–ø—Ä—è–º—É—é (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)

### **üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

- [ ] **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** 
  - [ ] –ù–ï–¢ –∫–æ–º–º–∏—Ç–æ–≤ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤, token'–æ–≤, –ø–∞—Ä–æ–ª–µ–π
  - [ ] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `.env` –¥–ª—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - [ ] Personal data –ø–æ–º–µ—á–µ–Ω–∞ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö

- [ ] **API –∫–ª—é—á–∏**
  - [ ] –í—Å–µ secrets –≤ `.env.sample` –∫–∞–∫ –ø—Ä–∏–º–µ—Ä—ã
  - [ ] –ù–ï–¢ hardcoded API keys/tokens

### **üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

- [ ] **Rate Limiting**
  - [ ] –ë–æ–ª—å—à–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `smart_pause()`
  - [ ] Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–º–µ—é—Ç –ª–∏–º–∏—Ç—ã (–Ω–µ –±–æ–ª–µ–µ 1000 –∑–∞ —Ä–∞–∑)
  
- [ ] **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
  - [ ] `try/except` –¥–ª—è Telegram API
  - [ ] `FloodWaitError` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  - [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç

### **üìù –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**

- [ ] **–°—Ç–∏–ª—å –∫–æ–¥–∞**
  - [ ] –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `make format-check` ‚úÖ
  - [ ] –õ–∏–Ω—Ç–∏–Ω–≥: `make lint` ‚úÖ
  - [ ] Naming conventions —Å–æ–±–ª—é–¥–µ–Ω—ã
  
- [ ] **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
  - [ ] Docstrings –¥–ª—è –≤—Å–µ—Ö public —Ñ—É–Ω–∫—Ü–∏–π
  - [ ] –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
  - [ ] README –æ–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### **üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

- [ ] **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏**
  - [ ] –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–µ—é—Ç unit —Ç–µ—Å—Ç—ã
  - [ ] –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç happy path –∏ edge cases
  - [ ] Mock'–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
  
- [ ] **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
  - [ ] –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ flow –∏–º–µ—é—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
  - [ ] –¢–µ—Å—Ç—ã –ù–ï —Ç—Ä–µ–±—É—é—Ç real Telegram connection

---

## üö® **–ö–†–ê–°–ù–´–ï –§–õ–ê–ì–ò (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π reject)**

### ‚ùå **–ë–õ–û–ö–ò–†–£–Æ–©–ò–ï –ø—Ä–æ–±–ª–µ–º—ã**

1. **–ü—Ä—è–º—ã–µ Telegram API –≤—ã–∑–æ–≤—ã –±–µ–∑ safe_call**
   ```python
   # ‚ùå –ù–ï –¢–ê–ö
   await client.get_entity("@group")
   async for user in client.iter_participants():
   
   # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û  
   await _safe_api_call(client.get_entity, "@group")
   await safe_call(client.get_entity, "@group", operation_type="api")
   ```

2. **–ö–æ–º–º–∏—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   ```json
   // ‚ùå –ù–ï –¢–ê–ö
   {"phone": "+1234567890", "api_id": "12345"}
   
   // ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
   // Personal data excluded from commit
   ```

3. **Hardcoded secrets**
   ```python
   # ‚ùå –ù–ï –¢–ê–ö
   API_ID = "12345"
   API_HASH = "abcdef123456"
   
   # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
   API_ID = os.getenv("API_ID")
   ```

4. **Broken tests**
   - –ï—Å–ª–∏ `make test` –ø–∞–¥–∞–µ—Ç - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π reject

---

## ‚úÖ **–ü–†–û–¶–ï–î–£–†–ê REVIEW**

### **üë®‚Äçüíª –î–ª—è –∞–≤—Ç–æ—Ä–∞ PR:**

1. **–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º PR:**
   ```bash
   # –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞
   make dev-check
   make test
   make anti-spam-check
   ```

2. **–í –æ–ø–∏—Å–∞–Ω–∏–∏ PR —É–∫–∞–∑–∞—Ç—å:**
   - [ ] Checklist –ø—Ä–æ–π–¥–µ–Ω ‚úÖ
   - [ ] –ê–Ω—Ç–∏-—Å–ø–∞–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—à–ª–∏ ‚úÖ 
   - [ ] –¢–µ—Å—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã/–æ–±–Ω–æ–≤–ª–µ–Ω—ã ‚úÖ
   - [ ] Breaking changes –æ–ø–∏—Å–∞–Ω—ã

### **üë• –î–ª—è reviewer:**

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
   ```bash
   git checkout feature-branch
   make check-all
   ```

2. **–†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
   - [ ] –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º
   - [ ] –ö–æ–¥ —á–∏—Ç–∞–µ–º—ã–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π
   - [ ] –ù–µ—Ç code smells
   
3. **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
   ```bash
   # –ü–æ–∏—Å–∫ –ø—Ä—è–º—ã—Ö API –≤—ã–∑–æ–≤–æ–≤
   grep -r "await.*client\." --include="*.py" . | grep -v safe_call
   
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ imports
   grep -r "from telethon" --include="*.py" .
   ```

### **üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ–¥–æ–±—Ä–µ–Ω–∏—è:**

- ‚úÖ –í—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ –ù–µ—Ç –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –ø—Ä–æ–±–ª–µ–º  
- ‚úÖ –ö–æ–¥ —Å–ª–µ–¥—É–µ—Ç architectural patterns
- ‚úÖ –¢–µ—Å—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

---

## üìû **–í —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º:**

### **üö® –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –∞–Ω—Ç–∏-—Å–ø–∞–º –Ω–∞—Ä—É—à–µ–Ω–∏—è:**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:**
   ```bash
   make telegram-api-audit
   python scripts/check_anti_spam_compliance.py
   ```

2. **–¢–∏–ø–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
   ```python
   # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ get_entity
   - await client.get_entity(group_id)
   + await _safe_api_call(client.get_entity, group_id)
   
   # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ iter_participants  
   - async for user in client.iter_participants(group):
   + async def get_users():
   +     users = []
   +     async for user in client.iter_participants(group):
   +         users.append(user)
   +     return users
   + users = await _safe_api_call(get_users)
   ```

3. **–î–æ–±–∞–≤–∏—Ç—å import –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:**
   ```python
   from tganalytics.infra.limiter import safe_call, smart_pause
   # –∏–ª–∏ –¥–ª—è group_manager.py
   # –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π _safe_api_call
   ```

### **‚ùì –ï—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—Ç–µ—Å—å:**

- –ó–∞–ø—É—Å—Ç–∏—Ç–µ `make telegram-api-audit` 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `docs/ANTI_SPAM_AUDIT_REPORT.md`
- –ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å lead developer

---

**üéØ –¶–µ–ª—å:** –û–±–µ—Å–ø–µ—á–∏—Ç—å 100% –∑–∞—â–∏—Ç—É –æ—Ç Telegram API –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞.