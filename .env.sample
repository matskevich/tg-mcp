# tg-mcp — example configuration
# Copy to .env and fill in your values

# Telegram auth (required)
TG_API_ID=
TG_API_HASH=

# Session name (for direct CLI debug only; MCP should use TG_SESSION_PATH)
SESSION_NAME=read_only_session

# MCP session behavior (optional)
TG_ALLOW_SESSION_SWITCH=0        # 1 to allow tg_use_session tool
TG_SESSION_LOCK_MODE=shared      # shared|exclusive (shared allows concurrent projects)
TG_WRITE_CONTEXT=read_mcp        # read_mcp|actions_mcp|custom
TG_BLOCK_DIRECT_TELETHON_WRITE=1 # 1 blocks direct client.send_* by default
TG_ALLOW_DIRECT_TELETHON_WRITE=0 # keep 0 in production; set 1 only for local debug
TG_ENFORCE_ACTION_PROCESS=1      # require real mcp_server_actions.py process for write
TG_ACTION_PROCESS=0              # set to 1 only in Action MCP process environment
TG_DIRECT_TELETHON_WRITE_ALLOWED_CONTEXTS=actions_mcp

# Actions MCP safety gates (optional)
TG_ACTIONS_ENABLED=1             # actions server can run, but allowlist still enforced
TG_ACTIONS_REQUIRE_ALLOWLIST=1   # require TG_ACTIONS_ALLOWED_GROUPS for actions
TG_ACTIONS_ALLOWED_GROUPS=        # comma-separated usernames/ids (no spaces)
TG_ACTIONS_MAX_MESSAGE_LEN=2000  # max message_text length for tg_send_message
TG_ACTIONS_MAX_FILE_MB=20        # max file size for tg_send_file
TG_ACTIONS_REQUIRE_CONFIRMATION_TEXT=1  # require explicit confirmation_text for non-dry-run writes
TG_ACTIONS_CONFIRMATION_PHRASE=отправляй # exact confirmation_text required for execution
TG_ACTIONS_MIN_CONFIRM_TEXT_LEN=6       # minimum length of confirmation_text
TG_ACTIONS_REQUIRE_APPROVAL_CODE=1       # require one-time approval_code from dry_run preview
TG_ACTIONS_APPROVAL_TTL_SEC=1800         # approval code lifetime (30 min)
TG_ACTIONS_APPROVAL_MIN_AGE_SEC=30       # block immediate execute right after dry_run
TG_ACTIONS_APPROVAL_FILE=data/anti_spam/action_approvals.json
TG_ACTIONS_IDEMPOTENCY_ENABLED=1        # block duplicate actions in idempotency window
TG_ACTIONS_IDEMPOTENCY_WINDOW_SEC=86400 # duplicate block window (24h)
TG_ACTIONS_IDEMPOTENCY_FILE=data/anti_spam/action_idempotency.json
TG_ACTIONS_BATCH_FILE=data/anti_spam/action_batches.json
TG_ACTIONS_BATCH_TTL_HOURS=168          # batch approval validity (hours)
TG_ACTIONS_BATCH_APPROVAL_LEASE_SEC=86400  # run permission lease for approved batch (24h)
TG_ACTIONS_BATCH_RUN_LEASE_SEC=1800     # lock one batch run against parallel workers (30 min)
TG_ACTIONS_UNSAFE_OVERRIDE=0            # keep 0; 1 allows non-safe policy settings

# Safety limits (recommended defaults)
RATE_RPS=4                      # requests per second
TG_GLOBAL_RPS_MODE=shared       # shared|local|off; shared limits RPS across processes
TG_FLOOD_CIRCUIT_THRESHOLD_SEC=300  # trip breaker when FLOOD_WAIT >= threshold (0 to disable)
TG_FLOOD_CIRCUIT_COOLDOWN_SEC=900   # block calls while breaker is open
MAX_DM_PER_DAY=20               # direct messages per day
MAX_JOINS_PER_DAY=20            # join/leave operations per day
MAX_GROUP_MSGS_PER_DAY=30       # group/channel messages per day (actions MCP)
MAX_GROUPS=200                  # max groups for account

# Anti-spam advanced settings (optional)
# RETRY_MAX_ATTEMPTS=3          # max retry on FLOOD_WAIT
# SMART_PAUSE_PARTICIPANTS=5000 # pause every N participants
# SMART_PAUSE_DM_BATCH=20       # pause every N DM

# Logging (optional)
LOG_LEVEL=INFO
SAFE_LOG_ENABLED=true

# Data directories (optional)
DATA_DIR=data
SESSIONS_DIR=data/sessions
EXPORT_DIR=data/export
ANTI_SPAM_DIR=data/anti_spam
LOGS_DIR=data/logs

# Security settings (optional)
SESSION_PERMISSIONS=600
ENABLE_2FA_CHECK=true
CHECK_USERNAME=true
CHECK_PROFILE_PHOTO=true
CHECK_BIO=true
WARMUP_PERIOD_HOURS=24

# Development (optional)
DEBUG_MODE=false
TEST_MODE=false
DRY_RUN=false

# Proxy (optional)
# PROXY_URL=socks5://user:pass@host:port
